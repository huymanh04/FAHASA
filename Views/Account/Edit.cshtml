@model SportsStore.Models.ViewModels.EditProfileModel

@{
    ViewData["Title"] = "Chỉnh sửa hồ sơ";
    Layout = "_ProfileLayout";
}

<style>
    .edit-header {
        text-align: center;
        margin-bottom: 40px;
        padding-bottom: 30px;
        border-bottom: 2px solid #f0f0f0;
    }

    .edit-header h4 {
        font-size: 2rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 20px;
    }

    .avatar-preview-container {
        text-align: center;
        margin-bottom: 30px;
    }

    .avatar-preview-wrapper {
        position: relative;
        display: inline-block;
    }

    .avatar-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        object-fit: cover;
        border: 4px solid white;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }

    .avatar-placeholder-preview {
        width: 150px;
        height: 150px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        font-size: 3rem;
        border: 4px solid white;
        box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
    }

    .form-group {
        margin-bottom: 25px;
    }

    .form-label {
        font-weight: 600;
        color: #333;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .form-label i {
        color: #667eea;
        font-size: 1.1rem;
    }

    .form-control {
        border: 2px solid #e0e0e0;
        border-radius: 12px;
        padding: 12px 16px;
        font-size: 1rem;
        transition: all 0.3s ease;
    }

    .form-control:focus {
        border-color: #667eea;
        box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
        outline: none;
    }

    .file-input-wrapper {
        position: relative;
        display: inline-block;
        width: 100%;
    }

    .file-input-label {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        padding: 12px 20px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .file-input-label:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .file-input-wrapper input[type="file"] {
        position: absolute;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
    }

    .btn-save {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        padding: 12px 30px;
        border-radius: 25px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
    }

    .btn-save:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    }

    .btn-cancel {
        background: white;
        color: #667eea;
        border: 2px solid #667eea;
        padding: 12px 30px;
        border-radius: 25px;
        font-weight: 600;
        text-decoration: none;
        transition: all 0.3s ease;
    }

    .btn-cancel:hover {
        background: #667eea;
        color: white;
        transform: translateY(-2px);
    }

    .text-danger {
        color: #f5576c !important;
        font-size: 0.9rem;
        margin-top: 5px;
    }

    .form-actions {
        display: flex;
        gap: 15px;
        justify-content: flex-start;
        margin-top: 30px;
        padding-top: 30px;
        border-top: 2px solid #f0f0f0;
    }

    @@media (max-width: 768px) {
        .form-actions {
            flex-direction: column;
        }

        .btn-save,
        .btn-cancel {
            width: 100%;
        }
    }
</style>

<div class="edit-header">
    <h4>
        <i class="fas fa-edit me-2"></i>
        Chỉnh sửa thông tin cá nhân
</h4>
</div>

<div class="avatar-preview-container">
    <div class="avatar-preview-wrapper">
@if (!string.IsNullOrEmpty(Model.AvatarUrl))
{
            <img src="@Model.AvatarUrl" alt="Avatar" class="avatar-preview" id="avatarPreview" />
        }
        else
        {
            <div class="avatar-placeholder-preview" id="avatarPlaceholder">
                <i class="fas fa-user"></i>
            </div>
        }
    </div>
</div>

<form asp-action="Edit" method="post" enctype="multipart/form-data">
    <div class="form-group">
        <label asp-for="FullName" class="form-label">
            <i class="fas fa-signature"></i>
            Họ tên
        </label>
        <input asp-for="FullName" class="form-control" placeholder="Nhập họ tên của bạn" />
        <span asp-validation-for="FullName" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="PhoneNumber" class="form-label">
            <i class="fas fa-phone"></i>
            Số điện thoại
        </label>
        <input asp-for="PhoneNumber" class="form-control" placeholder="Nhập số điện thoại" />
        <span asp-validation-for="PhoneNumber" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="BirthDate" class="form-label">
            <i class="fas fa-birthday-cake"></i>
            Ngày sinh
        </label>
        <input asp-for="BirthDate" type="date" class="form-control" />
        <span asp-validation-for="BirthDate" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="Address" class="form-label">
            <i class="fas fa-map-marker-alt"></i>
            Địa chỉ
        </label>
        <input asp-for="Address" class="form-control" placeholder="Nhập địa chỉ của bạn" />
        <span asp-validation-for="Address" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label class="form-label">
            <i class="fas fa-image"></i>
            Ảnh đại diện
        </label>
        <div class="file-input-wrapper">
            <label for="avatarFile" class="file-input-label">
                <i class="fas fa-upload"></i>
                Chọn ảnh đại diện
            </label>
            <input type="file" name="AvatarFile" id="avatarFile" class="form-control" accept="image/*" />
        </div>
        <small class="text-muted d-block mt-2">
            <i class="fas fa-info-circle"></i>
            Chọn file ảnh để cập nhật ảnh đại diện của bạn
        </small>
    </div>

    <div class="form-actions">
        <button type="submit" class="btn btn-save">
            <i class="fas fa-save me-2"></i>
            Lưu thay đổi
        </button>
        <a href="/Account/Profile" class="btn btn-cancel">
            <i class="fas fa-times me-2"></i>
            Hủy
        </a>
    </div>
</form>

@section Scripts {
    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
    
    <script>
        // Preview avatar khi chọn file
        document.getElementById('avatarFile')?.addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const preview = document.getElementById('avatarPreview');
                    const placeholder = document.getElementById('avatarPlaceholder');
                    
                    if (preview) {
                        preview.src = e.target.result;
                    } else if (placeholder) {
                        placeholder.outerHTML = `<img src="${e.target.result}" alt="Avatar" class="avatar-preview" id="avatarPreview" />`;
                    }
                };
                reader.readAsDataURL(file);
            }
        });
    </script>
}
